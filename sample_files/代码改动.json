{
  "success": true,
  "data": {
    "current": [
      "package com.example.user;\n\nimport java.util.List;\nimport java.util.Date;\n\npublic class UserService {\n\n    private UserRepository userRepository;\n    private EmailService emailService;\n\n    public User createUser(String name, String email) {\n        if (name == null || name.isEmpty()) {\n            throw new IllegalArgumentException(\"Name cannot be empty\");\n        }\n        if (email == null || !email.contains(\"@\")) {\n            throw new IllegalArgumentException(\"Invalid email format\");\n        }\n        User user = new User(name, email);\n        user.setStatus(\"active\");\n        user.setCreatedAt(new Date());\n        User saved = userRepository.save(user);\n        emailService.sendWelcomeEmail(saved.getEmail());\n        return saved;\n    }\n\n    public User updateUser(Long id, String name, String email) {\n        User user = userRepository.findById(id);\n        if (user == null) {\n            throw new RuntimeException(\"User not found\");\n        }\n        if (\"deleted\".equals(user.getStatus())) {\n            throw new RuntimeException(\"Cannot update deleted user\");\n        }\n        user.setName(name);\n        user.setEmail(email);\n        user.setUpdatedAt(new Date());\n        return userRepository.save(user);\n    }\n\n    public void deleteUser(Long id) {\n        User user = userRepository.findById(id);\n        if (user == null) {\n            throw new RuntimeException(\"User not found\");\n        }\n        user.setStatus(\"deleted\");\n        user.setDeletedAt(new Date());\n        userRepository.save(user);\n    }\n\n    public List<User> listUsers(int page, int size) {\n        if (page < 0 || size <= 0) {\n            throw new IllegalArgumentException(\"Invalid pagination parameters\");\n        }\n        return userRepository.findAll(page, size);\n    }\n\n    public User getUserById(Long id) {\n        User user = userRepository.findById(id);\n        if (user == null) {\n            throw new RuntimeException(\"User not found\");\n        }\n        return user;\n    }\n}",
      "package com.example.order;\n\nimport java.math.BigDecimal;\nimport java.util.List;\nimport java.util.Date;\n\npublic class OrderService {\n\n    private OrderRepository orderRepository;\n    private UserService userService;\n    private InventoryService inventoryService;\n\n    public Order createOrder(Long userId, List<OrderItem> items) {\n        if (items == null || items.isEmpty()) {\n            throw new IllegalArgumentException(\"Order items cannot be empty\");\n        }\n        userService.getUserById(userId);\n        for (OrderItem item : items) {\n            if (!inventoryService.checkStock(item.getProductId(), item.getQuantity())) {\n                throw new RuntimeException(\"Insufficient stock for product: \" + item.getProductId());\n            }\n        }\n        BigDecimal total = calculateTotal(items);\n        Order order = new Order(userId, items, total);\n        order.setStatus(\"pending\");\n        order.setCreatedAt(new Date());\n        return orderRepository.save(order);\n    }\n\n    public Order cancelOrder(Long orderId) {\n        Order order = orderRepository.findById(orderId);\n        if (order == null) {\n            throw new RuntimeException(\"Order not found\");\n        }\n        if (!\"pending\".equals(order.getStatus())) {\n            throw new RuntimeException(\"Only pending orders can be cancelled\");\n        }\n        order.setStatus(\"cancelled\");\n        order.setCancelledAt(new Date());\n        return orderRepository.save(order);\n    }\n\n    private BigDecimal calculateTotal(List<OrderItem> items) {\n        return items.stream()\n            .map(item -> item.getPrice().multiply(new BigDecimal(item.getQuantity())))\n            .reduce(BigDecimal.ZERO, BigDecimal::add);\n    }\n\n    public Order getOrderById(Long orderId) {\n        Order order = orderRepository.findById(orderId);\n        if (order == null) {\n            throw new RuntimeException(\"Order not found\");\n        }\n        return order;\n    }\n}"
    ],
    "history": [
      "package com.example.user;\n\nimport java.util.List;\n\npublic class UserService {\n\n    private UserRepository userRepository;\n\n    public User createUser(String name, String email) {\n        User user = new User(name, email);\n        return userRepository.save(user);\n    }\n\n    public User updateUser(Long id, String name, String email) {\n        User user = userRepository.findById(id);\n        user.setName(name);\n        user.setEmail(email);\n        return userRepository.save(user);\n    }\n\n    public List<User> listUsers(int page, int size) {\n        return userRepository.findAll(page, size);\n    }\n}",
      "package com.example.order;\n\nimport java.math.BigDecimal;\nimport java.util.List;\n\npublic class OrderService {\n\n    private OrderRepository orderRepository;\n\n    public Order createOrder(Long userId, List<OrderItem> items) {\n        BigDecimal total = calculateTotal(items);\n        Order order = new Order(userId, items, total);\n        return orderRepository.save(order);\n    }\n\n    private BigDecimal calculateTotal(List<OrderItem> items) {\n        return items.stream()\n            .map(item -> item.getPrice().multiply(new BigDecimal(item.getQuantity())))\n            .reduce(BigDecimal.ZERO, BigDecimal::add);\n    }\n}"
    ]
  }
}
